### YamlMime:ManagedReference
items:
- uid: System.IdentityModel.Services.Tokens.MachineKeySessionSecurityTokenHandler
  id: MachineKeySessionSecurityTokenHandler
  children:
  - System.IdentityModel.Services.Tokens.MachineKeySessionSecurityTokenHandler.#ctor
  - System.IdentityModel.Services.Tokens.MachineKeySessionSecurityTokenHandler.#ctor(System.TimeSpan)
  langs:
  - csharp
  name: MachineKeySessionSecurityTokenHandler
  nameWithType: MachineKeySessionSecurityTokenHandler
  fullName: System.IdentityModel.Services.Tokens.MachineKeySessionSecurityTokenHandler
  type: Class
  summary: "通过使用 ASP.NET 中指定的签名和加密密钥来处理会话令牌<xref uid=&quot;langword_csharp_&lt;machineKey&gt;&quot; name=&quot;&lt;machineKey&gt;&quot; href=&quot;&quot;></xref>配置文件中的元素。"
  remarks: "默认情况下，<xref:System.IdentityModel.Tokens.SessionSecurityTokenHandler>类使用<xref:System.IdentityModel.ProtectedDataCookieTransform>类，该类使用数据保护 API (DPAPI) 来保护会话令牌。</xref:System.IdentityModel.ProtectedDataCookieTransform> </xref:System.IdentityModel.Tokens.SessionSecurityTokenHandler> DPAPI 使用的用户或计算机的凭据提供保护，并将密钥数据存储在用户配置文件。 这意味着，会话令牌签名和加密的一台计算机上无法验证或其他计算机上解密。       与此相反，MachineKeySessionSecurityTokenHandler 类使用<xref:System.IdentityModel.Services.MachineKeyTransform>类，使用来保护会话 cookie 数据中指定的加密材料`<machineKey>`配置文件中的元素。</xref:System.IdentityModel.Services.MachineKeyTransform> 这意味着，可以跨多台计算机使用相同的密钥 （和会话令牌）。 当 web 场中部署应用程序时，这一点特别重要。 有关如何使用 Windows Identity Foundation 来保护 web 场中部署的应用程序的详细信息，请参阅[WIF 和 Web 场](~/add/includes/ajax-current-ext-md.md)。       配置用于 MachineKeySessionSecurityTokenHandler 通过将其添加到令牌处理程序集合的应用程序。 你必须首先删除<xref:System.IdentityModel.Tokens.SessionSecurityTokenHandler>(或任何处理程序派生自<xref:System.IdentityModel.Tokens.SessionSecurityTokenHandler>类) 从标记处理程序集合，如果存在此类处理。</xref:System.IdentityModel.Tokens.SessionSecurityTokenHandler> </xref:System.IdentityModel.Tokens.SessionSecurityTokenHandler> 这是因为 MachineKeySessionSecurityTokenHandler 派生自<xref:System.IdentityModel.Tokens.SessionSecurityTokenHandler>和令牌处理程序集合不能包含任何给定的类型的多个处理程序。</xref:System.IdentityModel.Tokens.SessionSecurityTokenHandler>"
  example:
  - "The following XML shows how to use the ASP.NET `<machineKey>` element in configuration to explicitly specify signing and encryption keys. The `<machineKey>` element is specified under the `<system.web>` element in a configuration file.  \n  \n```xml  \n<machineKey compatibilityMode=\"Framework45\" decryptionKey=\"CC510D … 8925E6\" validationKey=\"BEAC8 … 6A4B1DE\" />  \n```  \n  \n The following XML shows how to add the MachineKeySessionSecurityTokenHandler to a token handler collection. The default <xref:System.IdentityModel.Tokens.SessionSecurityTokenHandler> is first removed from the collection. Token handlers are configured under the [\\&lt;securityTokenHandlers\\&gt;](../Topic/%3CsecurityTokenHandlers%3E.md) element.  \n  \n```xml  \n<securityTokenHandlers>  \n  <remove type=\"System.IdentityModel.Tokens.SessionSecurityTokenHandler, System.IdentityModel, Version=4.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089\" />  \n  <add type=\"System.IdentityModel.Services.Tokens.MachineKeySessionSecurityTokenHandler, System.IdentityModel.Services, Version=4.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089\" />  \n</securityTokenHandlers>  \n```"
  syntax:
    content: 'public class MachineKeySessionSecurityTokenHandler : System.IdentityModel.Tokens.SessionSecurityTokenHandler'
  inheritance:
  - System.Object
  - System.IdentityModel.Tokens.SecurityTokenHandler
  - System.IdentityModel.Tokens.SessionSecurityTokenHandler
  implements: []
  inheritedMembers:
  - System.IdentityModel.Tokens.SecurityTokenHandler.CanReadKeyIdentifierClause(System.Xml.XmlReader)
  - System.IdentityModel.Tokens.SecurityTokenHandler.CanReadToken(System.String)
  - System.IdentityModel.Tokens.SecurityTokenHandler.CanWriteKeyIdentifierClause(System.IdentityModel.Tokens.SecurityKeyIdentifierClause)
  - System.IdentityModel.Tokens.SecurityTokenHandler.Configuration
  - System.IdentityModel.Tokens.SecurityTokenHandler.ContainingCollection
  - System.IdentityModel.Tokens.SecurityTokenHandler.CreateSecurityTokenReference(System.IdentityModel.Tokens.SecurityToken,System.Boolean)
  - System.IdentityModel.Tokens.SecurityTokenHandler.DetectReplayedToken(System.IdentityModel.Tokens.SecurityToken)
  - System.IdentityModel.Tokens.SecurityTokenHandler.ReadKeyIdentifierClause(System.Xml.XmlReader)
  - System.IdentityModel.Tokens.SecurityTokenHandler.ReadToken(System.String)
  - System.IdentityModel.Tokens.SecurityTokenHandler.TraceTokenValidationFailure(System.IdentityModel.Tokens.SecurityToken,System.String)
  - System.IdentityModel.Tokens.SecurityTokenHandler.TraceTokenValidationSuccess(System.IdentityModel.Tokens.SecurityToken)
  - System.IdentityModel.Tokens.SecurityTokenHandler.WriteKeyIdentifierClause(System.Xml.XmlWriter,System.IdentityModel.Tokens.SecurityKeyIdentifierClause)
  - System.IdentityModel.Tokens.SecurityTokenHandler.WriteToken(System.IdentityModel.Tokens.SecurityToken)
  - System.IdentityModel.Tokens.SessionSecurityTokenHandler.ApplyTransforms(System.Byte[],System.Boolean)
  - System.IdentityModel.Tokens.SessionSecurityTokenHandler.CanReadToken(System.Xml.XmlReader)
  - System.IdentityModel.Tokens.SessionSecurityTokenHandler.CanValidateToken
  - System.IdentityModel.Tokens.SessionSecurityTokenHandler.CanWriteToken
  - System.IdentityModel.Tokens.SessionSecurityTokenHandler.CookieElementName
  - System.IdentityModel.Tokens.SessionSecurityTokenHandler.CookieNamespace
  - System.IdentityModel.Tokens.SessionSecurityTokenHandler.CreateSessionSecurityToken(System.Security.Claims.ClaimsPrincipal,System.String,System.String,System.DateTime,System.DateTime)
  - System.IdentityModel.Tokens.SessionSecurityTokenHandler.CreateToken(System.IdentityModel.Tokens.SecurityTokenDescriptor)
  - System.IdentityModel.Tokens.SessionSecurityTokenHandler.DefaultCookieTransforms
  - System.IdentityModel.Tokens.SessionSecurityTokenHandler.DefaultLifetime
  - System.IdentityModel.Tokens.SessionSecurityTokenHandler.DefaultTokenLifetime
  - System.IdentityModel.Tokens.SessionSecurityTokenHandler.GetTokenTypeIdentifiers
  - System.IdentityModel.Tokens.SessionSecurityTokenHandler.LoadCustomConfiguration(System.Xml.XmlNodeList)
  - System.IdentityModel.Tokens.SessionSecurityTokenHandler.ReadToken(System.Byte[],System.IdentityModel.Selectors.SecurityTokenResolver)
  - System.IdentityModel.Tokens.SessionSecurityTokenHandler.ReadToken(System.Xml.XmlReader)
  - System.IdentityModel.Tokens.SessionSecurityTokenHandler.ReadToken(System.Xml.XmlReader,System.IdentityModel.Selectors.SecurityTokenResolver)
  - System.IdentityModel.Tokens.SessionSecurityTokenHandler.SetTransforms(System.Collections.Generic.IEnumerable{System.IdentityModel.CookieTransform})
  - System.IdentityModel.Tokens.SessionSecurityTokenHandler.TokenLifetime
  - System.IdentityModel.Tokens.SessionSecurityTokenHandler.TokenType
  - System.IdentityModel.Tokens.SessionSecurityTokenHandler.Transforms
  - System.IdentityModel.Tokens.SessionSecurityTokenHandler.ValidateSession(System.IdentityModel.Tokens.SessionSecurityToken)
  - System.IdentityModel.Tokens.SessionSecurityTokenHandler.ValidateToken(System.IdentityModel.Tokens.SecurityToken)
  - System.IdentityModel.Tokens.SessionSecurityTokenHandler.ValidateToken(System.IdentityModel.Tokens.SessionSecurityToken,System.String)
  - System.IdentityModel.Tokens.SessionSecurityTokenHandler.WriteToken(System.IdentityModel.Tokens.SessionSecurityToken)
  - System.IdentityModel.Tokens.SessionSecurityTokenHandler.WriteToken(System.Xml.XmlWriter,System.IdentityModel.Tokens.SecurityToken)
  platform:
  - net462
- uid: System.IdentityModel.Services.Tokens.MachineKeySessionSecurityTokenHandler.#ctor
  id: '#ctor'
  parent: System.IdentityModel.Services.Tokens.MachineKeySessionSecurityTokenHandler
  langs:
  - csharp
  name: MachineKeySessionSecurityTokenHandler()
  nameWithType: MachineKeySessionSecurityTokenHandler.MachineKeySessionSecurityTokenHandler()
  fullName: System.IdentityModel.Services.Tokens.MachineKeySessionSecurityTokenHandler.MachineKeySessionSecurityTokenHandler()
  type: Constructor
  assemblies:
  - System.IdentityModel.Services
  namespace: System.IdentityModel.Services.Tokens
  summary: "初始化的新实例<xref href=&quot;System.IdentityModel.Services.Tokens.MachineKeySessionSecurityTokenHandler&quot;></xref>类。"
  syntax:
    content: public MachineKeySessionSecurityTokenHandler ();
    parameters: []
  overload: System.IdentityModel.Services.Tokens.MachineKeySessionSecurityTokenHandler.#ctor*
  exceptions: []
  platform:
  - net462
- uid: System.IdentityModel.Services.Tokens.MachineKeySessionSecurityTokenHandler.#ctor(System.TimeSpan)
  id: '#ctor(System.TimeSpan)'
  parent: System.IdentityModel.Services.Tokens.MachineKeySessionSecurityTokenHandler
  langs:
  - csharp
  name: MachineKeySessionSecurityTokenHandler(TimeSpan)
  nameWithType: MachineKeySessionSecurityTokenHandler.MachineKeySessionSecurityTokenHandler(TimeSpan)
  fullName: System.IdentityModel.Services.Tokens.MachineKeySessionSecurityTokenHandler.MachineKeySessionSecurityTokenHandler(TimeSpan)
  type: Constructor
  assemblies:
  - System.IdentityModel.Services
  namespace: System.IdentityModel.Services.Tokens
  summary: "初始化的新实例<xref href=&quot;System.IdentityModel.Services.Tokens.MachineKeySessionSecurityTokenHandler&quot;></xref>具有指定的默认令牌生存期的类。"
  syntax:
    content: public MachineKeySessionSecurityTokenHandler (TimeSpan tokenLifetime);
    parameters:
    - id: tokenLifetime
      type: System.TimeSpan
      description: "默认令牌生存期。"
  overload: System.IdentityModel.Services.Tokens.MachineKeySessionSecurityTokenHandler.#ctor*
  exceptions:
  - type: System.InvalidOperationException
    commentId: T:System.InvalidOperationException
    description: "<code>tokenLifetime</code>小于或等于&lt;xref:System.TimeSpan?displayProperty=fullName&gt;"
  platform:
  - net462
references:
- uid: System.IdentityModel.Tokens.SessionSecurityTokenHandler
  isExternal: false
  name: System.IdentityModel.Tokens.SessionSecurityTokenHandler
- uid: System.InvalidOperationException
  isExternal: true
  name: System.InvalidOperationException
- uid: System.IdentityModel.Services.Tokens.MachineKeySessionSecurityTokenHandler.#ctor
  parent: System.IdentityModel.Services.Tokens.MachineKeySessionSecurityTokenHandler
  isExternal: false
  name: MachineKeySessionSecurityTokenHandler()
  nameWithType: MachineKeySessionSecurityTokenHandler.MachineKeySessionSecurityTokenHandler()
  fullName: System.IdentityModel.Services.Tokens.MachineKeySessionSecurityTokenHandler.MachineKeySessionSecurityTokenHandler()
- uid: System.IdentityModel.Services.Tokens.MachineKeySessionSecurityTokenHandler.#ctor(System.TimeSpan)
  parent: System.IdentityModel.Services.Tokens.MachineKeySessionSecurityTokenHandler
  isExternal: false
  name: MachineKeySessionSecurityTokenHandler(TimeSpan)
  nameWithType: MachineKeySessionSecurityTokenHandler.MachineKeySessionSecurityTokenHandler(TimeSpan)
  fullName: System.IdentityModel.Services.Tokens.MachineKeySessionSecurityTokenHandler.MachineKeySessionSecurityTokenHandler(TimeSpan)
- uid: System.TimeSpan
  parent: System
  isExternal: true
  name: TimeSpan
  nameWithType: TimeSpan
  fullName: System.TimeSpan
- uid: System.IdentityModel.Services.Tokens.MachineKeySessionSecurityTokenHandler.#ctor*
  parent: System.IdentityModel.Services.Tokens.MachineKeySessionSecurityTokenHandler
  isExternal: false
  name: MachineKeySessionSecurityTokenHandler
  nameWithType: MachineKeySessionSecurityTokenHandler.MachineKeySessionSecurityTokenHandler
